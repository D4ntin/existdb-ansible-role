# Custom Java options for this eXist-db instance
#
# pass each custom Java option on a separate line
# comments and whitespace lines get stripped before applying options

# HTTP/TLS ports
-Djetty.port={{ exist_http_port }}
-Djetty.ssl.port={{ exist_ssl_port }}

# initial and max Java heap memory
-Xms{{ exist_mem_init_heap }}m
-Xmx{{ exist_mem_max_heap }}m

# max Java metaspace and direct memory sizes
-XX:MaxMetaspaceSize={{ exist_mem_max_meta }}m
-XX:MaxDirectMemorySize={{ exist_mem_max_direct }}m

# GC (default G1 GC)
-XX:+UseG1GC
-XX:MaxGCPauseMillis=200
{% if exist_mem_gcdebug_enable == True %}
# GC logging/debugging
-XX:+PrintGCDetails
-XX:+PrintGCDateStamps
-Xloggc:{{ exist_path }}/logs/gc-%t.log
{% endif %}

# NMT (native memory tracking)
-XX:NativeMemoryTracking=detail
-XX:+UnlockDiagnosticVMOptions
-XX:+PrintNMTStatistics

# string deduplication, requires Java >= 8u20 and G1 GC
-XX:+UseStringDeduplication
-XX:+PrintStringDeduplicationStatistics

# Java NIO cache tuning (256k) to work around high direct memory consumption
# by java.nio
# requires Java >= 8u102, should not be needed with Java 11
-Djdk.nio.maxCachedBufferSize=262144

# tmp dir
-Djava.io.tmpdir={{ exist_home }}/tmp
